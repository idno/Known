## BEGIN Known Webserver Config (don't remove)

<IfModule mod_rewrite.c>
    RewriteEngine on
    #RewriteBase /

    RewriteRule ^\.git(|hub)/ - [F]

    RewriteCond %{HTTP:Authorization} ^(.+)$
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    RewriteCond %{ENV:BASE} ^$
    RewriteCond $1::%{REQUEST_URI} ^(.*)::(.*?)\1$
    RewriteRule ^(.*)$ - [ENV=BASE:%2]

    RewriteRule ^js/canary\.js$ %{ENV:BASE}/js/known.min.js [L]

    # The query string cache trick doesn't really work, so use rewrite rules instead
    RewriteRule ^js/[0-9]+/(.*)$ %{ENV:BASE}/js/$1 [L]    
    RewriteRule ^css/[0-9]+/(.*)$ %{ENV:BASE}/css/$1 [L]    

    # If serving minified js and a SourceMap file exists, send appropriate header
    RewriteCond %{REQUEST_URI}          ^(.+[.\-]min\.js)$
    RewriteCond %{DOCUMENT_ROOT}%1.map  -f
    RewriteRule .                       - [L,E=SOURCE_MAP:%{REQUEST_URI}.map]
    Header set X-SourceMap "%{SOURCE_MAP}e" env=SOURCE_MAP

    # Rewrite to use index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ %{ENV:BASE}/index.php?/$1 [L,QSA]
    RewriteRule ^Uploads.* - [F]
</IfModule>
<Files  ~ "\.dist$">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "composer\.lock">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "composer\.json">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "package\.json">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "Gruntfile\.js">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "known\.php">
  Order allow,deny
  Deny from all
</Files>
<Files  ~ "\.known">
  Order allow,deny
  Deny from all
</Files>
<Files  ~ "\.ini$">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "\.yml$">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "\.xml$">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "\.bak$">
  Order allow,deny
  Deny from all
</Files>
<Files ~ "sitemap\.xml">
  Order allow,deny
  Allow from all
</Files>
<Files ~ "feed\.xml">
  Order allow,deny
  Allow from all
</Files>
<Files ~ "rss\.xml">
  Order allow,deny
  Allow from all
</Files>
#<Files ~ "\.php$">
#  Order allow,deny
#  Deny from all
#</Files>
<Files ~ "warmup\/*\.*">
  Order allow,deny
  Allow from all
</Files>
<Files ~ "index\.php">
  Order allow,deny
  Allow from all
</Files>

AddType video/ogg .ogv
AddType video/mp4 .mp4
AddType video/webm .webm

# If you have problems uploading large images try uncommenting these lines
#
#   php_value post_max_size 64M
#   php_value upload_max_filesize 60M

## END Known Webserver Config (don't remove)
